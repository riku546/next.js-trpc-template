pre-commit:
  commands:
    biome check:
      glob: "*.{js,ts,cjs,mjs,d.cts,d.mts,jsx,tsx,json,jsonc}"
      run: npx @biomejs/biome check .  --no-errors-on-unmatched --files-ignore-unknown=true --colors=off
    typecheck:
      run: pnpm typecheck 


    
post-merge:
  commands:
    drizzle-generate-on-schema-change:
      run: |
        BASE_REF=${ORIG_HEAD:-HEAD^}
        CHANGED_FILES=$(git diff --name-only "$BASE_REF" HEAD | tr -d '\r')
        if echo "$CHANGED_FILES" | grep -x -q 'src/db/schema.ts'; then
          pnpm db:generate || exit 1
        fi
        true
    pnpm-install-on-package-json-change:
      run: |
        BASE_REF=${ORIG_HEAD:-HEAD^}
        CHANGED_FILES=$(git diff --name-only "$BASE_REF" HEAD | tr -d '\r')
        if echo "$CHANGED_FILES" | grep -x -q 'package.json'; then
          pnpm install || exit 1
        fi
        true
    prepare-on-lefthook-config-change:
      run: |
        BASE_REF=${ORIG_HEAD:-HEAD^}
        CHANGED_FILES=$(git diff --name-only "$BASE_REF" HEAD | tr -d '\r')
        if echo "$CHANGED_FILES" | grep -x -q 'lefthook.yml'; then
          pnpm prepare || exit 1
        fi
        true
